class MainSidebar extends HTMLElement{constructor(){if(super(),this.SCROLL_EVENT=e=>{this.offsetHeight>window.innerHeight?this.style.transform="translate3d(0,"+window.scrollY*-1+"px, 0)":this.style.transform="translate3d(0,"+(this.offsetHeight-window.innerHeight)*-1+"px, 0)"},this.addEventListener("scroll",this.SCROLL_EVENT,{passive:!0}),this.RESIZE_EVENT=debounce(()=>{this.offsetHeight>window.innerHeight?this.SCROLL_EVENT():this.style.transform="translate3d(0, 0, 0)",this.setSidebarHeight()},300),this.addEventListener("resize",this.RESIZE_EVENT,{passive:!0}),setTimeout(()=>{this.RESIZE_EVENT()},310),!document.body.classList.contains("template-cart")&&KROWN.settings.cart_action=="overlay"){const sidebarCart=document.querySelector(".sidebar__cart");document.querySelector(".sidebar__cart-handle")&&document.querySelector(".sidebar__cart-handle").addEventListener("click",e=>{e.preventDefault(),sidebarCart.show()}),document.querySelector(".sidebar__cart-handle")&&document.querySelector(".sidebar__cart-handle").addEventListener("keyup",e=>{e.keyCode==window.KEYCODES.RETURN&&setTimeout(()=>{document.querySelector(".sidebar__cart .sidebar__cart-close").focus()},100)})}const sidebarSearch=document.querySelector(".sidebar__search");JSON.parse(document.getElementById("shopify-features").text).predictiveSearch?(this.closePredictiveSearch=(()=>{document.querySelector(".sidebar").classList.remove("no-transforms"),sidebarSearch.classList.remove("open-search"),sidebarSearch.classList.remove("opened"),this.querySelector("[data-js-search-results]").classList.remove("show"),document.body.classList.remove("overflow-hidden"),document.querySelector(".cart-overlay-background").classList.remove("show"),document.querySelector(".cart-overlay-background").removeEventListener("click",this.closePredictiveSearch)}).bind(this),document.querySelector(".sidebar__search-handle")&&document.querySelector(".sidebar__search-handle").addEventListener("click",e=>{window.getComputedStyle(sidebarSearch,":after").content.includes("predictive-mobile")&&(e.preventDefault(),sidebarSearch.classList.contains("opened")?sidebarSearch.hide():(sidebarSearch.show(),setTimeout(()=>{document.querySelector("[data-js-search-input]").focus()},50)))}),this.querySelector('input[type="search"]')&&this.querySelector('input[type="search"]').addEventListener("click",e=>{sidebarSearch.classList.contains("open-search")||(this.setSidebarHeight(),document.querySelector(".sidebar").classList.add("no-transforms"),sidebarSearch.classList.add("open-search"),sidebarSearch.classList.add("opened"),this.querySelector("[data-js-search-results]").classList.add("show"),document.body.classList.add("overflow-hidden"),document.querySelector(".cart-overlay-background").classList.add("show"),document.querySelector(".cart-overlay-background").addEventListener("click",this.closePredictiveSearch))}),this.querySelector(".sidebar__search-close")&&this.querySelector(".sidebar__search-close").addEventListener("click",e=>{window.getComputedStyle(sidebarSearch,":after").content.includes("predictive-mobile")||this.closePredictiveSearch()}),document.addEventListener("keydown",e=>{if(e.keyCode==window.KEYCODES.ESC){const afterContent=window.getComputedStyle(sidebarSearch,":after").content;sidebarSearch.classList.contains("open-search")&&!afterContent.includes("predictive-mobile")&&this.closePredictiveSearch()}})):(document.querySelector(".sidebar__search-handle")&&document.querySelector(".sidebar__search-handle").addEventListener("click",e=>{e.preventDefault(),sidebarSearch.classList.contains("opened")?sidebarSearch.classList.remove("opened"):(sidebarSearch.classList.add("opened"),document.querySelector('.sidebar__search input[type="search"]').setAttribute("placeholder",document.querySelector('.sidebar__search input[type="search"]').dataset.responsivePlaceholder),setTimeout(()=>{document.querySelector('.sidebar__search input[type="search"]').focus()},100))}),document.querySelector(".sidebar__search")&&document.querySelector(".sidebar__search").classList.remove("predictive-search"));const sidebarMenus=document.querySelector(".sidebar__menus");document.querySelector(".sidebar__menu-handle")&&document.querySelector(".sidebar__menu-handle").addEventListener("click",e=>{e.preventDefault(),sidebarMenus.classList.remove("kill-overflow"),sidebarMenus.classList.contains("opened")?sidebarMenus.hide():sidebarMenus.show()});let submenuLevel=0;document.querySelectorAll(".sidebar__menus .sidebar__menu .has-submenu > a").forEach(elm=>{elm.addEventListener("click",e=>{window.innerWidth<=948&&(e.preventDefault(),e.stopPropagation(),sidebarMenus.classList.add("kill-overflow"),sidebarMenus.scrollTop=0,elm.parentNode.classList.contains("has-second-submenu")?submenuLevel=2:submenuLevel=1,elm.parentNode.classList.add("open-submenu"),elm.parentNode.parentNode.classList.add("opened-submenu"),elm.closest(".sidebar__menus").classList.add("opened-submenus"),elm.parentNode.parentNode.parentNode.classList.contains("primary-menu")?elm.parentNode.parentNode.parentNode.nextElementSibling.classList.add("opened-other-submenu"):elm.parentNode.parentNode.parentNode.previousElementSibling.classList.add("opened-other-submenu"))})}),document.querySelector(".sidebar__menus-back").addEventListener("click",e=>{submenuLevel==1?(submenuLevel=0,sidebarMenus.classList.remove("opened-submenus"),sidebarMenus.querySelector("nav.opened-other-submenu").classList.remove("opened-other-submenu"),sidebarMenus.querySelector(".opened-submenu").classList.remove("opened-submenu"),sidebarMenus.querySelector(".open-submenu").classList.remove("open-submenu"),sidebarMenus.classList.remove("kill-overflow")):submenuLevel==2&&(submenuLevel=1,document.querySelector(".has-second-submenu.open-submenu").parentNode.classList.remove("opened-submenu"),document.querySelector(".has-second-submenu.open-submenu").classList.remove("open-submenu"))}),this.sidebarParentFLAG=!1,this.sidebarSeconds=document.querySelector(".sidebar__seconds"),this.sidebarSecondsDOM=document.querySelector(".sidebar__seconds .sidebar__menu"),this.sidebarSecondsFLAG=!1,this.sidebarThirds=document.querySelector(".sidebar__thirds"),this.sidebarThirdsDOM=document.querySelector(".sidebar__thirds .sidebar__menu"),this.sidebarThirdsFLAG=!1,document.querySelectorAll(".has-first-submenu > a").forEach(elm=>{elm.addEventListener("touchstart",e=>{window.innerWidth>948&&(e.preventDefault(),elm.parentNode.querySelectorAll("a")[0].style.pointerEvents="none",this.onMouseEnterHandlerFirst({currentTarget:elm.parentNode,preventDefault:()=>{}}))},{passive:!0})}),document.querySelectorAll(".has-first-submenu").forEach(elm=>{elm.addEventListener("mouseenter",this.onMouseEnterHandlerFirst.bind(this)),elm.addEventListener("mouseleave",this.onMouseLeaveHandlerFirst.bind(this))}),this.sidebarSeconds.addEventListener("mouseenter",()=>{document.body.classList.add("show-overlay"),this.sidebarSeconds.classList.add("opened"),this.sidebarSeconds.querySelector(".sidebar__submenu--first")&&this.sidebarSeconds.querySelector(".sidebar__submenu--first").classList.add("submenu-opened")}),this.sidebarSeconds.addEventListener("mouseleave",this.onMouseLeaveHandlerFirst.bind(this)),this.sidebarThirds.addEventListener("mouseenter",()=>{document.body.classList.add("show-overlay"),this.sidebarThirds.classList.add("opened"),this.sidebarSeconds.classList.add("opened"),this.sidebarSeconds.querySelector(".sidebar__submenu--first").classList.add("submenu-opened"),this.sidebarThirds.querySelector(".sidebar__submenu--second").classList.add("submenu-opened")}),this.sidebarThirds.addEventListener("mouseleave",()=>{this.onMouseLeaveHandlerFirst(),this.onMouseLeaveHandlerSecond()});let activeElement=document.activeElement,activeMenu_l1=null,activeMenu_l2=null,activeMenu_lFlag=!1;document.addEventListener("keyup",e=>{e.keyCode==window.KEYCODES.TAB&&(document.activeElement.classList.contains("parent-has-submenu")?(document.activeElement.parentNode.classList.contains("has-first-submenu")?this.onMouseEnterHandlerFirst({currentTarget:document.activeElement.parentNode,preventDefault:()=>{}}):document.activeElement.parentNode.classList.contains("has-second-submenu")&&this.onMouseEnterHandlerSecond({currentTarget:document.activeElement.parentNode,preventDefault:()=>{}}),document.activeElement.classList.contains("sub-menu__link-second")?document.activeElement.classList.contains("sub-menu__last-second")?(activeMenu_l2=activeMenu_l1,activeMenu_lFlag=!0):activeMenu_l2=document.activeElement.parentNode.nextElementSibling.querySelector(":scope > a"):document.activeElement.parentNode.nextElementSibling?activeMenu_l1=document.activeElement.parentNode.nextElementSibling.querySelector(":scope > a"):document.activeElement.dataset.type=="primary"?activeMenu_l1=document.querySelector(".secondary-menu").querySelectorAll("a")[0]:document.activeElement.dataset.type=="secondary"&&(document.querySelector(".accounts-menu")?activeMenu_l1=document.querySelector(".accounts-menu").querySelectorAll("a")[0]:document.querySelector(".sidebar .localization-form__item")?activeMenu_l1=document.querySelectorAll(".sidebar .localization-form__item")[0].querySelectorAll("button")[0]:activeMenu_l1=document.querySelector(".sidebar .sidebar__search form"))):activeElement.classList.contains("sub-menu__last-second")?!activeElement.classList.contains("parent-has-submenu")||activeElement.classList.contains("ran-over")?(activeMenu_l1&&activeMenu_l1.focus(),this.onMouseLeaveHandlerFirst()):activeElement.classList.add("ran-over"):activeElement.classList.contains("sub-menu__last-third")&&(activeMenu_l2&&activeMenu_l2.focus(),this.onMouseLeaveHandlerSecond(),document.activeElement.classList.contains("sub-menu__last-second")&&document.activeElement.classList.contains("ran-over")?(this.onMouseLeaveHandlerFirst(),this.onMouseLeaveHandlerSecond(),activeMenu_l1&&activeMenu_l1.focus()):document.activeElement.parentNode.classList.contains("has-second-submenu")&&(this.onMouseEnterHandlerSecond({currentTarget:document.activeElement.parentNode,preventDefault:()=>{}}),document.activeElement.classList.contains("sub-menu__last-second")||(activeMenu_l2=document.activeElement.parentNode.nextElementSibling.querySelector(":scope > a"))),activeMenu_lFlag&&(activeMenu_lFlag=!1,this.onMouseLeaveHandlerFirst())),activeElement=document.activeElement)}),document.addEventListener("keydown",e=>{e.keyCode==window.KEYCODES.TAB?activeElement.classList.contains("parent-has-submenu")&&(e.preventDefault(),this.sidebarSeconds.querySelectorAll("a")[0].focus(),activeElement.classList.contains("sub-menu__link-second")&&this.sidebarThirds.querySelectorAll("a")[0].focus()):e.keyCode==window.KEYCODES.ESC&&(this.sidebarSecondsFLAG&&this.onMouseLeaveHandlerFirst(),this.sidebarThirdsFLAG&&this.onMouseLeaveHandlerSecond())})}onMouseEnterHandlerFirst(e){if(window.innerWidth>948){e.preventDefault(),document.body.classList.add("show-overlay"),this.sidebarSeconds.classList.add("opened"),this.sidebarSecondsFLAG=!0;let openedSubmenu=document.createElement("div");openedSubmenu.classList.add("clone"),openedSubmenu.innerHTML=e.currentTarget.querySelector(":scope > .sidebar__submenu").outerHTML,openedSubmenu=openedSubmenu.querySelector(":scope > div"),(!this.sidebarSecondsDOM.querySelector(".sidebar__submenu")||this.sidebarSecondsDOM.querySelector(".sidebar__submenu").dataset.handle!=openedSubmenu.dataset.handle)&&(this.sidebarSecondsDOM.innerHTML=openedSubmenu.outerHTML),this.sidebarSecondsDOM.querySelector(":scope > .sidebar__submenu .sub-menu").style.paddingTop=e.currentTarget.getBoundingClientRect().top+"px",setTimeout(()=>{this.sidebarSecondsDOM.querySelector(":scope > .sidebar__submenu").classList.add("submenu-opened")},10),this.sidebarSecondsDOM.querySelectorAll(".has-second-submenu").forEach(elm=>{elm.addEventListener("touchstart",e2=>{e2.preventDefault(),elm.parentNode.querySelectorAll("a")[0].style.pointerEvents="none",this.onMouseEnterHandlerSecond({currentTarget:elm,preventDefault:()=>{}}),this.sidebarThirdsFLAG&&this.onMouseLeaveHandlerSecond()},{passive:!0}),elm.addEventListener("mouseenter",this.onMouseEnterHandlerSecond.bind(this)),elm.addEventListener("mouseleave",()=>{this.sidebarThirdsFLAG&&this.onMouseLeaveHandlerSecond()})}),e.currentTarget.addEventListener("mouseleave",this.onMouseLeaveHandlerSecond.bind(this))}}onMouseEnterHandlerSecond(e){e.preventDefault(),this.sidebarThirds.classList.add("opened"),this.sidebarThirdsFLAG=!0;let openedSubmenu=document.createElement("div");openedSubmenu.classList.add("clone"),openedSubmenu.innerHTML=e.currentTarget.querySelector(":scope > .sidebar__submenu").outerHTML,openedSubmenu=openedSubmenu.querySelector(":scope > div"),(!this.sidebarThirdsDOM.querySelector(".sidebar__submenu")||this.sidebarThirdsDOM.querySelector(".sidebar__submenu")&&this.sidebarThirdsDOM.querySelector(".sidebar__submenu").dataset.handle!=openedSubmenu.dataset.handle)&&(this.sidebarThirdsDOM.innerHTML=openedSubmenu.outerHTML),this.sidebarThirdsDOM.querySelector(":scope > .sidebar__submenu .sub-menu").style.paddingTop=e.currentTarget.getBoundingClientRect().top+"px",setTimeout(()=>{this.sidebarThirdsDOM.querySelector(":scope > .sidebar__submenu").classList.add("submenu-opened")},10)}onMouseLeaveHandlerFirst(){this.sidebarSeconds.classList.remove("opened"),this.sidebarSeconds.querySelector(".submenu-opened")&&this.sidebarSeconds.querySelector(".submenu-opened").classList.remove("submenu-opened"),document.body.classList.remove("show-overlay"),this.sidebarSecondsFLAG=!1}onMouseLeaveHandlerSecond(){this.sidebarThirds.classList.remove("opened"),this.sidebarThirds.querySelector(".submenu-opened")&&this.sidebarThirds.querySelector(".submenu-opened").classList.remove("submenu-opened"),this.sidebarThirdsFLAG=!1}setSidebarHeight(){document.querySelectorAll(".sidebar__cart, .sidebar__cart .cart, .sidebar__search, .collection__filters, .collection__filters .filters").forEach(elm=>{elm.style.height=window.innerHeight+"px"}),document.querySelector(".sidebar__menus").style.height=window.innerHeight+"px",document.querySelector(".sidebar__search.predictive-search .sidebar__search-results")&&(document.querySelector(".sidebar__search.predictive-search .sidebar__search-results").style.maxHeight=`${window.innerHeight-(document.body.classList.contains("show-announcement-bar")?200:160)}px`)}}customElements.define("main-sidebar",MainSidebar);let overlay=document.createElement("span");overlay.className="cart-overlay-background",overlay.addEventListener("click",()=>{document.querySelector("sidebar-drawer.opened").hide()}),document.body.append(overlay),overlay=document.createElement("span"),overlay.className="sidebar-overlay-background",overlay.addEventListener("click",()=>{document.querySelector("sidebar-drawer.opened").hide()}),document.body.append(overlay);class SidebarDrawer extends HTMLElement{constructor(){super(),this.querySelector("[data-js-close]").addEventListener("click",()=>{this.hide()}),document.addEventListener("keydown",e=>{if(e.keyCode==window.KEYCODES.ESC){const openedSidebar=document.querySelector("sidebar-drawer.opened");openedSidebar&&openedSidebar.hide()}}),this.setAttribute("style","")}show(){this.opened=!0,this.classList.add("opened"),document.body.classList.add("overflow-hidden"),this.dataset.overlay=="sidebar"?document.querySelector(".sidebar-overlay-background").classList.add("show"):this.dataset.overlay=="cart"&&document.querySelector(".cart-overlay-background").classList.add("show"),document.querySelectorAll(".sidebar__cart, .sidebar__cart .cart, .sidebar__search, .collection__filters, .collection__filters .filters").forEach(elm=>{elm.style.height=window.innerHeight+"px"}),document.querySelector(".sidebar__menus").style.height=window.innerHeight+"px",document.querySelector(".sidebar__search.predictive-search .sidebar__search-results")&&(document.querySelector(".sidebar__search.predictive-search .sidebar__search-results").style.maxHeight=window.innerHeight-170+"px"),this._mountA11YHelper()}hide(){this.opened=!1,this.classList.remove("opened"),document.body.classList.remove("overflow-hidden"),this.dataset.overlay=="sidebar"?document.querySelector(".sidebar-overlay-background").classList.remove("show"):this.dataset.overlay=="cart"&&document.querySelector(".cart-overlay-background").classList.remove("show"),this._unmountA11YHelper()}_mountA11YHelper(forcedFocus){let focusable=forcedFocus||this.querySelectorAll('[tabindex="0"], button, [href], input:not([type="hidden"]), select, textarea, .regular-select-cover'),firstFocusable=focusable[0],lastFocusable=focusable[focusable.length-1];this.classList.contains("sidebar__cart")&&!this.querySelector(".cart__form").classList.contains("cart--empty")&&(lastFocusable=focusable[focusable.length-2]),this.A11Y_TAB_EVENT=((firstFocusable2,lastFocusable2,e)=>{(e.key==="Tab"||e.keyCode===window.KEYCODES.TAB)&&(e.shiftKey?document.activeElement===firstFocusable2&&(lastFocusable2.focus(),e.preventDefault()):document.activeElement===lastFocusable2&&(firstFocusable2.focus(),e.preventDefault()))}).bind(this,firstFocusable,lastFocusable),this.addEventListener("keydown",this.A11Y_TAB_EVENT)}_unmountA11YHelper(sidebar){this.removeEventListener("keydown",this.A11Y_TAB_EVENT)}}customElements.define("sidebar-drawer",SidebarDrawer);
//# sourceMappingURL=/cdn/shop/t/6/assets/section-sidebar.js.map?v=172807448067203081941729104791
